@use './../../utils/scss/text-ellipsis' as ellipsis;

@layer components {
  .indicators {
    position: absolute;
    padding: 0;
    top: 0;
    height: var(--selectHeight, 100%);
    right: var(--indicatorsRight, var(--spacing-md));
    display: flex;
    gap: var(--spacing-xs);

    &.size-xs {
      --indicatorsRight: var(--spacing-sm);
    }
  }

  .dropdown-indicator {
    position: relative;
    height: 100%;
    padding: 0;
    outline: none !important; /* important for firefox */
    appearance: none;
    cursor: pointer;
    border: none;
    background: transparent;
    display: flex;
    align-items: center;
    justify-content: center;
    max-height: var(--selectHeight);

    .styled-icon {
      transform: none;
      transition-property: transform;
      transition-duration: var(--duration-medium);
      transition-timing-function: var(--timing-primary);
    }

    &.open {
      .styled-icon {
        transform: rotate3d(0, 0, 1, 180deg);
      }
    }

    &:not(:last-child) {
      width: auto;
    }

    &.disabled {
      cursor: not-allowed;
      color: var(--input-color-text-disabled);
    }
  }

  .input-wrapper {
    position: relative;

    &:has(> .icon-placement-right) {
      .indicators {
        /* icon size + spacing */
        --indicatorsRight: calc(var(--spacing-lg) + var(--spacing-md) * 2);
      }
    }
  }

  .root {
    --selectPlaceholderColor: var(--input-color-text-placeholder);
    background-color: var(
      --selectBackgroundColor,
      var(--input-color-background-default)
    );
    border-color: var(--selectBorderColor, var(--input-color-border-default));
    border-radius: var(--input-border-radius);
    border-style: solid;
    border-width: var(--input-border-width-default);
    color: var(--selectTextColor, var(--input-color-text-default));
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-regular);
    line-height: var(--selectLineHeight, 1);
    outline: none;
    cursor: default;
    width: 100%;
    transition-property: all;
    transition-timing-function: var(--timing-primary);
    transition-duration: var(--duration-medium);
    height: var(--selectHeight);
    padding-bottom: var(--selectPaddingBottom);
    padding-left: var(--selectPaddingLeft);
    padding-right: calc(var(--selectPaddingRight) + var(--spacing-xl)); /* extra space for dropdown indicator */
    padding-top: var(--selectPaddingTop);
    @include ellipsis.text-ellipsis;
    box-shadow: var(--selectBoxShadow, var(--inset-10)) inset;

    /* left icon or both */
    &.icon-placement-left,
    &.icon-placement-both {
      padding-left: calc(
        var(--selectPaddingLeft) + var(--selectIconSize, 1rem) + var(--spacing-sm)
      );
    }

    /* is clearable or right icon */
    &.clearable,
    &.icon-placement-right,
    &.icon-placement-both {
      padding-right: calc(
        var(--selectPaddingRight) + var(--selectIconSize, 1rem) + var(--spacing-sm) + var(--spacing-xl)
      );
    }

    /* is clearable and got a right/both icon */
    &.clearable.icon-placement-right,
    &.clearable.icon-placement-both {
      padding-right: calc(
        var(--selectPaddingRight) + (var(--selectIconSize, 1rem) + var(--spacing-sm)) * 2 + var(--spacing-xl)
      );
    }

    &.disabled {
      --selectBackgroundColor: var(--input-color-background-disabled);
      --selectTextColor: var(--input-color-text-disabled);
      cursor: not-allowed;
    }

    /* hover when no variant is defined */
    &:hover:not(.disabled) {
      --selectBorderColor: var(--input-color-border-hover);
      --selectBoxShadow: var(--inset-20);
    }

    /* focus when no variant is defined */
    &:focus:not(.disabled) {
      --selectBorderColor: var(--input-color-border-active);
    }

    &.transparent {
      --selectBorderColor: transparent;
      --selectBackgroundColor: var(--input-color-background-transparent);

      &:hover {
        --selectBorderColor: var(--input-color-border-hover-transparent);
      }
    }

    &::placeholder {
      color: var(--selectPlaceholderColor);
    }

    br {
      display: none;
    }

    &::before {
      content: attr(data-spacer);
      visibility: hidden;
      display: block;
      height: 0;
    }

    &:empty {
      &::after {
        content: attr(placeholder);
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        padding: inherit;
        line-height: 1.25;
        color: var(--selectPlaceholderColor);
        @include ellipsis.text-ellipsis;
      }

      &::before {
        height: auto;
      }
    }
  }

  .variant {
    &-danger {
      --selectBorderColor: var(--input-color-border-error);
    }

    &-success {
      --selectBorderColor: var(--input-color-border-success);
    }

    &-warning {
      --selectBorderColor: var(--input-color-border-warning);
    }
  }

  .size {
    &-lg {
      --selectHeight: var(--input-max-height-lg);
      --selectPaddingBottom: var(--input-padding-block-lg);
      --selectPaddingLeft: var(--input-padding-inline-lg);
      --selectPaddingRight: var(--input-padding-inline-lg);
      --selectPaddingTop: var(--input-padding-block-lg);
      --selectLineHeight: 1.15;
    }

    &-md {
      --selectHeight: var(--input-max-height-md);
      --selectPaddingBottom: var(--input-padding-block-md);
      --selectPaddingLeft: var(--input-padding-inline-md);
      --selectPaddingRight: var(--input-padding-inline-md);
      --selectPaddingTop: var(--input-padding-block-md);
      --selectLineHeight: 1;
    }

    &-sm {
      --selectHeight: var(--input-max-height-sm);
      --selectPaddingBottom: var(--input-padding-block-sm);
      --selectPaddingLeft: var(--input-padding-inline-sm);
      --selectPaddingRight: var(--input-padding-inline-sm);
      --selectPaddingTop: var(--input-padding-block-sm);
      --selectLineHeight: 1;
    }
  }

  .icon-wrapper {
    position: absolute;
    top: 0;
    bottom: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    pointer-events: none;
    transition-property: all;
    transition-timing-function: var(--timing-primary);
    transition-duration: var(--duration-medium);

    left: var(--iconPlacementLeft, auto);
    right: var(--iconPlacementRight, auto);
    color: var(--selectIconWrapperColor, var(--input-color-icon-default));

    &.icon-placement-left {
      --iconPlacementLeft: var(--spacing-md);
      &.size-xs {
        --iconPlacementLeft: var(--spacing-sm);
      }
    }

    &.icon-placement-right {
      --iconPlacementRight: var(--spacing-md);
      &.size-xs {
        --iconPlacementRight: var(--spacing-sm);
      }
    }

    /* for button action */
    & > button {
      pointer-events: auto;
    }
  }

  .wrapper {
    position: relative;
    width: 100%;

    &.disabled .icon-wrapper {
      --selectIconWrapperColor: var(--input-color-icon-disabled);
    }
  }

  .menu {
    max-height: 9.6875rem; /* 155px */
    background-color: var(--input-color-background-default);
    border-color: var(--input-color-border-hover);
    border-radius: var(--input-border-radius);
    border-style: solid;
    border-width: var(--input-border-width-default);
    color: var(--input-color-text-default);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-regular);
    line-height: var(--font-line-height-md);
    outline: none;
    position: absolute;
    z-index: 2;
    right: 0;
    left: 0;
    margin: 0;
    margin-top: var(--spacing-md);
    padding: 0;
    transition-property: all;
    transition-timing-function: var(--timing-primary);
    transition-duration: var(--duration-medium);
    overflow: auto;
    -webkit-overflow-scrolling: touch;

    &:hover > * {
      cursor: pointer;
    }
  }

  .item {
    color: var(--itemTextColor, var(--color-text-warm-tertiary));
    cursor: var(--itemCursor, default);
    padding: var(--spacing-md);
    list-style: none;
    text-decoration: none;
    font-size: var(--font-size-sm);
    transition-property: background;
    transition-duration: var(--duration-medium);
    transition-timing-function: var(--timing-primary);
    @include ellipsis.text-ellipsis;

    &.highlighted {
      background-color: var(--color-background-warm-primary);
    }

    &.selected {
      &:not(.multiple) {
        --itemTextColor: var(--input-color-text-default);
        font-weight: var(--font-weight-semi-bold);
      }
      &.multiple:not(.allowUnselectFromList) {
        --itemTextColor: var(--color-beige-40);
        --itemCursor: not-allowed;
      }
    }

    &.disabled {
      --itemTextColor: var(--input-color-text-disabled);
      --itemCursor: not-allowed;
    }
  }

  .tags {
    margin-top: var(--spacing-lg);

    .styled-tag:not(:last-child) {
      margin-right: var(--spacing-sm);
      margin-bottom: var(--spacing-sm);
    }

    &:empty {
      display: none;
    }
  }
}
