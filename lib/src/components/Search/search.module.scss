@use '../../utils/scss/text-ellipsis.scss' as ellipsis;

@layer components {
  .wrapper {
    position: relative;
  }

  .indicators {
    position: absolute;
    padding: 0;
    top: 0;
    height: var(--searchHeight, 100%);
    right: var(--indicatorsRight, 0);
    display: flex;
    gap: var(--border-radius-sm);
  }

  .dropdown-indicator {
    position: relative;
    height: 100%;
    width: var(--searchClearSize);
    padding: 0;
    outline: none !important; /* important for firefox */
    appearance: none;
    cursor: pointer;
    background: transparent;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .input-wrapper {
    position: relative;

    &:has(> .icon-placement-right) {
      .indicators {
        --indicatorsRight: calc((var(--searchIconSize, 1rem) + var(--border-radius-md)));
      }
    }
  }

  .root {
    border-radius: var(--components-dimensions-input-border-radius);
    border-style: solid;
    border-width: var(--components-dimensions-input-border-width-default);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-regular);
    line-height: var(--font-line-height-md);
    outline: none;
    width: 100%;
    transition: var(--duration-medium);
    appearance: none;
    cursor: default;
    @include ellipsis.text-ellipsis;

    /* VARIABLES THAT CHANGE WITH REACT PROPS */
    background-color: var(
      --searchBackgroundColor,
      var(--components-colors-input-color-background-default)
    );
    color: var(--searchColor, var(--components-colors-input-color-text-default));
    border-color: var(--searchBorderColor, var(--components-colors-input-color-border-default));
    box-shadow: var(--searchBoxShadow, var(--inset-10)) inset;
    height: var(--searchHeight);
    padding-inline: var(--searchPaddingInline);
    padding-block: var(--searchPaddingBlock);

    /* left icon */
    &.icon-placement-left {
      padding-left: calc(
        var(--searchPaddingLeft) + var(--searchIconSize, 1rem) + var(--border-radius-md)
      );
    }

    /*  right icon */
    &.icon-placement-right {
      padding-right: calc(
        var(--searchPaddingRight) + (var(--searchIconSize, 1rem) + var(--border-radius-md)) * 2
      );
    }

    &:disabled,
    &[aria-disabled] {
      --searchBackgroundColor: var(
        --searchBackgroundColorDisabled,
        var(--components-colors-input-color-background-disabled)
      );
      --searchColor: var(--components-colors-input-color-text-disabled);
      cursor: not-allowed;
    }

    &:hover:not(:disabled):not([aria-disabled]) {
      --borderColor: var(--borderColorHover, var(--color-border-neutral-subtlest));
      --searchBoxShadow: var(--inset-20);
    }

    &:active,
    &:focus {
      --searchBorderColor: var(--components-colors-input-color-border-focused);
    }

    &::placeholder {
      color: var(--components-colors-input-color-text-placeholder);
    }

    br {
      display: none;
    }
  }

  .variant {
    &-danger {
      --searchBorderColor: var(--components-colors-input-color-border-error);
    }

    &-warning {
      --searchBorderColor: var(--components-colors-input-color-border-warning);
    }

    &-success {
      --searchBorderColor: var(--components-colors-input-color-border-success);
    }
  }

  .transparent {
    --borderColor: transparent;
    --searchBackgroundColor: var(--components-colors-input-color-background-transparent);
    --borderColorHover: var(--components-colors-input-color-border-hover-transparent);
  }

  .size {
    &-lg {
      --searchHeight: var(--components-dimensions-input-max-height-lg);
      --searchPaddingBlock: var(--components-dimensions-input-padding-block-lg);
      --searchPaddingInline: var(--components-dimensions-input-padding-inline-lg);
    }

    &-md {
      --searchHeight: var(--components-dimensions-input-max-height-md);
      --searchPaddingBlock: var(--components-dimensions-input-padding-block-md);
      --searchPaddingInline: var(--components-dimensions-input-padding-inline-md);
    }

    &-sm {
      --searchHeight: var(--components-dimensions-input-max-height-sm);
      --searchPaddingBlock: var(--components-dimensions-input-padding-block-sm);
      --searchPaddingInline: var(--components-dimensions-input-padding-inline-sm);
    }
  }

  .icon-wrapper {
    position: absolute;
    top: 0;
    bottom: 0;
    left: var(--searchIconLeft);
    right: var(--searchIconRight);
    display: flex;
    justify-content: center;
    align-items: center;
    pointer-events: none;
    transition: var(--duration-medium);
    transition-timing-function: var(--timing-primary);
    color: var(--searchIconColor, var(--components-colors-input-color-icon-placeholder));
    gap: var(--components-dimensions-input-padding-block-sm);

    --searchIconLeft: auto;
    --searchIconRight: auto;

    /* for button action */
    & > button {
      pointer-events: auto;
    }

    &.disabled {
      --searchIconColor: var(--components-colors-input-color-icon-disabled);
    }
  }

  .icon-placement {
    &-left {
      &-sm {
        --searchIconLeft: var(--components-dimensions-input-padding-inline-sm);
      }

      &-md {
        --searchIconLeft: var(--components-dimensions-input-padding-inline-md);
      }
    }

    &-right {
      &-sm {
        --searchIconRight: var(--components-dimensions-input-padding-inline-sm);
      }

      &-md {
        --searchIconRight: var(--components-dimensions-input-padding-inline-md);
      }
    }
  }

  .menu {
    max-height: 9.6875rem; /* 155px */
    background-color: var(--color-background-neutral-inverse-fixed);
    border-color: var(--color-background-neutral-subtlest);
    border-radius: var(--border-radius-md);
    border-style: solid;
    border-width: var(--border-width-xs);
    box-shadow: var(--elevation-20);
    color: var(--color-background-neutral-primary-fixed);
    font-size: var(--font-size-14);
    font-weight: var(--font-weight-regular);
    line-height: var(--border-radius-xl);
    outline: none;
    position: absolute;
    z-index: 2;
    right: 0;
    left: 0;
    margin-top: var(--border-radius-lg);
    transition-property: all;
    transition-timing-function: var(--timing-primary);
    transition-duration: var(--duration-medium);
    overflow: hidden;

    &:hover > * {
      cursor: pointer;
    }
  }

  .menu-scroller {
    max-height: inherit;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    margin: 0;
    padding: 0;
  }

  .item {
    color: var(--itemTextColor, var(--color-icon-warm-tertiary));
    cursor: var(--itemCursor, default);
    padding: var(--border-radius-lg);
    list-style: none;
    text-decoration: none;
    font-size: var(--font-size-14);
    transition-property: background;
    transition-duration: var(--duration-medium);
    transition-timing-function: var(--timing-primary);
    @include ellipsis.text-ellipsis;

    &.highlighted {
      background-color: var(--color-background-warm-primary);
    }

    &.selected {
      --itemTextColor: var(--color-background-neutral-primary-fixed);
      font-weight: var(--font-weight-semi-bold);
    }

    &.selected.highlighted {
      background-image: linear-gradient(0deg, rgba(0, 0, 0, 0.08), rgba(0, 0, 0, 0.08) 100%);
    }
  }
}
